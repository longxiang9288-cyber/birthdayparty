<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 关键：绕过防盗链，保证音乐播放 -->
    <meta name="referrer" content="no-referrer">
    <title>冲哥34岁生日大局</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #0f172a;
            color: #e2e8f0;
            background-image: radial-gradient(circle at 50% 0%, #2e1065 0%, #0f172a 70%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(250, 204, 21, 0.5), 0 0 20px rgba(250, 204, 21, 0.3);
        }

        .neon-pink {
            text-shadow: 0 0 10px rgba(236, 72, 153, 0.6);
        }
        
        .timeline-line {
            position: absolute;
            left: 24px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #3b82f6, #facc15, #ec4899, #8b5cf6);
            z-index: 0;
        }

        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .7; }
        }

        .loader {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid #facc15;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .ai-gradient {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%);
        }

        .music-player {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 50;
            width: 50px;
            height: 50px;
            background: rgba(0,0,0,0.8);
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            backdrop-filter: blur(5px);
            overflow: hidden;
            box-shadow: 0 0 15px rgba(0,0,0,0.5);
        }
        .music-cover {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.6;
        }
        .music-icon {
            position: relative;
            z-index: 2;
        }
        .music-spin {
            animation: spin 4s linear infinite;
        }
        
        .vote-bar-bg {
            background-color: rgba(255,255,255,0.1);
            border-radius: 999px;
            overflow: hidden;
            height: 8px;
            margin-top: 8px;
        }
        .vote-bar-fill {
            height: 100%;
            transition: width 0.5s ease-out;
        }
    </style>
</head>
<body class="pb-20">

    <!-- 背景音乐 -->
    <audio id="bgMusic" loop autoplay>
        <source src="https://music.163.com/song/media/outer/url?id=1450707819.mp3" type="audio/mpeg">
    </audio>
    
    <div class="music-player music-spin" id="musicBtn" onclick="toggleMusic()">
        <div class="music-cover bg-gradient-to-br from-yellow-600 to-red-900"></div>
        <i class="fas fa-music text-white text-lg music-icon"></i>
    </div>

    <!-- 头部 -->
    <header class="relative text-center pt-16 pb-8 px-4 overflow-hidden">
        <div class="relative z-10">
            <div class="inline-block px-3 py-1 mb-4 rounded-full bg-indigo-600/30 border border-indigo-500/50 text-indigo-200 text-xs font-bold tracking-wider uppercase">
                本周六 · 11月22日
            </div>
            <h1 class="text-5xl font-black text-white mb-2 tracking-tight">
                冲哥 <span class="text-yellow-400 neon-text">34th</span>
            </h1>
            <h2 class="text-2xl font-bold text-slate-300 mb-6">BIRTHDAY PARTY</h2>
            <div class="flex justify-center space-x-2 text-sm text-slate-400">
                <span class="flex items-center"><i class="fas fa-users mr-2"></i> 6人精英局</span>
                <span class="mx-2">|</span>
                <span class="flex items-center"><i class="fas fa-map-marker-alt mr-2"></i> 深圳 · 福田</span>
            </div>
        </div>
        <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-96 h-96 bg-indigo-600 rounded-full blur-3xl opacity-20 -z-0"></div>
    </header>

    <main class="max-w-md mx-auto px-4 relative">
        <div class="timeline-line"></div>

        <!-- Part 1: 午后 -->
        <section class="relative z-10 mb-10 pl-12">
            <div class="absolute left-0 top-0 w-12 h-12 flex items-center justify-center">
                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center shadow-lg border-4 border-slate-900">
                    <i class="fas fa-sun text-white text-xs"></i>
                </div>
            </div>
            
            <div class="glass-card rounded-2xl p-5">
                <div class="flex justify-between items-start mb-2">
                    <h3 class="text-xl font-bold text-blue-300">Part 1. 午后集结</h3>
                    <span class="text-xs font-mono bg-slate-700 px-2 py-1 rounded text-slate-300">14:30</span>
                </div>
                <p class="text-slate-400 text-sm mb-4">养精蓄锐，投票决定 (本地模拟)</p>
                
                <div class="space-y-4">
                    <!-- 选项 A -->
                    <div class="bg-slate-800/50 p-3 rounded-lg border border-slate-700/50 relative overflow-hidden">
                        <div class="flex justify-between items-center mb-1 relative z-10">
                            <div class="flex items-center">
                                <i class="fas fa-chess-board text-emerald-400 mr-2"></i>
                                <div>
                                    <span class="font-bold text-white block">A. 雀神争霸</span>
                                    <span class="text-xs text-slate-400">梅林周边棋牌室</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <span id="count-optionA" class="text-emerald-400 font-bold text-lg">0</span>
                                <span class="text-xs text-slate-500">票</span>
                            </div>
                        </div>
                        <div class="flex justify-end mt-2 relative z-10">
                            <button onclick="vote('optionA')" class="bg-emerald-600 hover:bg-emerald-500 text-white text-xs px-4 py-1 rounded-full transition shadow-lg">
                                投这一票
                            </button>
                        </div>
                        <div class="vote-bar-bg relative z-10">
                            <div id="bar-optionA" class="vote-bar-fill bg-emerald-500" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- 选项 B -->
                    <div class="bg-slate-800/50 p-3 rounded-lg border border-slate-700/50 relative overflow-hidden">
                        <div class="flex justify-between items-center mb-1 relative z-10">
                            <div class="flex items-center">
                                <i class="fas fa-coffee text-orange-400 mr-2"></i>
                                <div>
                                    <span class="font-bold text-white block">B. 举杯消愁</span>
                                    <span class="text-xs text-slate-400">深业上城喝茶</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <span id="count-optionB" class="text-orange-400 font-bold text-lg">0</span>
                                <span class="text-xs text-slate-500">票</span>
                            </div>
                        </div>
                        <div class="flex justify-end mt-2 relative z-10">
                            <button onclick="vote('optionB')" class="bg-orange-600 hover:bg-orange-500 text-white text-xs px-4 py-1 rounded-full transition shadow-lg">
                                投这一票
                            </button>
                        </div>
                        <div class="vote-bar-bg relative z-10">
                            <div id="bar-optionB" class="vote-bar-fill bg-orange-500" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Part 2: 晚餐 -->
        <section class="relative z-10 mb-10 pl-12">
            <div class="absolute left-0 top-0 w-12 h-12 flex items-center justify-center">
                <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center shadow-lg border-4 border-slate-900 animate-pulse-slow">
                    <i class="fas fa-utensils text-slate-900 text-xs"></i>
                </div>
            </div>
            <div class="glass-card rounded-2xl p-5 border-yellow-500/30">
                <div class="flex justify-between items-start mb-2">
                    <h3 class="text-xl font-bold text-yellow-400">Part 2. 铜锅盛宴</h3>
                    <span class="text-xs font-mono bg-slate-700 px-2 py-1 rounded text-slate-300">18:00</span>
                </div>
                <p class="text-white font-medium mb-1">亮子铜锅涮肉 (中康路店)</p>
                <p class="text-slate-400 text-xs mb-3 flex items-center">
                    <i class="fas fa-birthday-cake text-pink-400 mr-1"></i> 切蛋糕仪式 
                    <span class="mx-2">•</span> 
                    <i class="fas fa-fire-alt text-red-500 mr-1"></i> 老北京景泰蓝
                </p>
                <div class="bg-slate-900/50 rounded-lg p-3">
                    <div class="text-xs text-slate-400 truncate mb-2">福田区中康路73号 (近上梅林地铁站)</div>
                    <div class="flex space-x-2">
                        <button onclick="copyText('深圳市福田区中康路73号')" class="flex-1 bg-slate-700 hover:bg-slate-600 py-2 rounded text-xs text-yellow-400 transition"><i class="far fa-copy mr-1"></i> 复制地址</button>
                        <button onclick="openMap('深圳市福田区中康路73号亮子铜锅涮肉')" class="flex-1 bg-yellow-600/20 hover:bg-yellow-600/40 border border-yellow-600/50 py-2 rounded text-xs text-yellow-400 transition"><i class="fas fa-location-arrow mr-1"></i> 高德导航</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Part 3: Livehouse -->
        <section class="relative z-10 mb-10 pl-12">
            <div class="absolute left-0 top-0 w-12 h-12 flex items-center justify-center">
                <div class="w-8 h-8 bg-pink-600 rounded-full flex items-center justify-center shadow-lg border-4 border-slate-900 animate-bounce">
                    <i class="fas fa-music text-white text-xs"></i>
                </div>
            </div>
            <div class="glass-card rounded-2xl p-5 border-pink-500/30 shadow-lg shadow-pink-900/20">
                <div class="flex justify-between items-start mb-2">
                    <h3 class="text-xl font-bold text-pink-400 neon-pink">Part 3. 音乐微醺</h3>
                    <span class="text-xs font-mono bg-slate-700 px-2 py-1 rounded text-slate-300">20:30</span>
                </div>
                <p class="text-white font-medium mb-1">響 Livehouse (华强北店)</p>
                <p class="text-slate-400 text-xs mb-3">音乐 / 骰子 / 34岁的狂欢 <span class="block text-red-400 mt-1 text-xs">*别跑去购物公园店了！</span></p>
                <div class="bg-slate-900/50 rounded-lg p-3">
                    <div class="text-xs text-slate-400 truncate mb-2">华强北深南中路2070号电子科技大厦D座8楼</div>
                    <div class="flex space-x-2">
                        <button onclick="copyText('深圳市福田区华强北街道深南中路2070号电子科技大厦D座8楼')" class="flex-1 bg-slate-700 hover:bg-slate-600 py-2 rounded text-xs text-pink-400 transition"><i class="far fa-copy mr-1"></i> 复制地址</button>
                        <button onclick="openMap('深圳市福田区华强北街道深南中路2070号电子科技大厦D座8楼')" class="flex-1 bg-pink-600/20 hover:bg-pink-600/40 border border-pink-600/50 py-2 rounded text-xs text-pink-400 transition"><i class="fas fa-location-arrow mr-1"></i> 高德导航</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI 助手 (本地模拟) -->
        <section class="relative z-10 pl-12 mb-8">
            <div class="absolute left-0 top-0 w-12 h-12 flex items-center justify-center">
                <div class="w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center shadow-lg border-4 border-slate-900">
                    <i class="fas fa-robot text-white text-xs"></i>
                </div>
            </div>
            <div class="glass-card rounded-2xl p-1 overflow-hidden border-purple-500/30">
                <div class="flex text-sm font-bold text-center">
                    <button onclick="switchTab('toast')" id="tab-toast" class="flex-1 py-3 bg-slate-700/50 text-purple-300 rounded-l-xl">AI 祝酒词</button>
                    <button onclick="switchTab('game')" id="tab-game" class="flex-1 py-3 text-slate-400 hover:text-white">气氛组长</button>
                </div>
                <div id="content-toast" class="p-4">
                    <p class="text-xs text-slate-400 mb-3">随机生成一条祝酒词 (本地版)</p>
                    <button onclick="generateToast()" class="w-full py-2 ai-gradient text-white font-bold rounded-lg shadow-lg hover:opacity-90 transition text-sm mb-3">✨ 生成祝酒词</button>
                    <div id="toastOutput" class="hidden bg-slate-900/80 p-3 rounded border border-slate-700 text-sm text-slate-200 leading-relaxed italic"></div>
                </div>
                <div id="content-game" class="hidden p-4">
                    <p class="text-xs text-slate-400 mb-3">随机推荐一个游戏 (本地版)</p>
                    <button onclick="generateGame()" class="w-full py-2 ai-gradient text-white font-bold rounded-lg shadow-lg hover:opacity-90 transition text-sm mb-3">✨ 推荐一个游戏</button>
                    <div id="gameOutput" class="hidden bg-slate-900/80 p-3 rounded border border-slate-700 text-sm text-slate-200 leading-relaxed"></div>
                </div>
            </div>
        </section>
    </main>

    <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-white text-slate-900 px-6 py-2 rounded-full shadow-2xl font-bold text-sm opacity-0 transition-opacity duration-300 pointer-events-none z-50">
        <i class="fas fa-check-circle text-green-500 mr-2"></i> <span id="toastMsg">地址已复制</span>
    </div>

    <footer class="text-center text-slate-600 text-xs mt-12 mb-8">
        <p>Made for Brother Chong | Happy 34th Birthday</p>
    </footer>

    <script>
        // 音乐控制
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        let isPlaying = true;

        document.addEventListener('DOMContentLoaded', () => {
            bgMusic.volume = 0.5;
            // 尝试自动播放
            bgMusic.play().catch(error => {
                console.log("自动播放受限，等待交互");
                isPlaying = false;
                musicBtn.classList.remove('music-spin');
                musicBtn.style.opacity = "0.5";
            });
        });

        // 第一次点击页面任意位置时恢复播放
        document.body.addEventListener('click', () => {
            if (!isPlaying && bgMusic.paused) {
                bgMusic.play();
                isPlaying = true;
                musicBtn.classList.add('music-spin');
                musicBtn.style.opacity = "1";
            }
        }, { once: true });

        function toggleMusic() {
            if (isPlaying) {
                bgMusic.pause();
                musicBtn.classList.remove('music-spin');
                musicBtn.style.opacity = "0.5";
            } else {
                bgMusic.play();
                musicBtn.classList.add('music-spin');
                musicBtn.style.opacity = "1";
            }
            isPlaying = !isPlaying;
        }

        // 地图功能 (核心修复点)
        function openMap(keyword) {
            const encodedQuery = encodeURIComponent(keyword);
            const url = `https://www.amap.com/search?query=${encodedQuery}`;
            window.open(url, '_blank');
        }

        // 复制功能
        function copyText(text) {
            navigator.clipboard.writeText(text).then(function() {
                showToast("地址已复制");
            }, function(err) {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand("Copy");
                textArea.remove();
                showToast("地址已复制");
            });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').innerText = msg;
            toast.classList.remove('opacity-0');
            setTimeout(() => {
                toast.classList.add('opacity-0');
            }, 2000);
        }

        function switchTab(tab) {
            const btnToast = document.getElementById('tab-toast');
            const btnGame = document.getElementById('tab-game');
            const contentToast = document.getElementById('content-toast');
            const contentGame = document.getElementById('content-game');

            if (tab === 'toast') {
                btnToast.className = "flex-1 py-3 bg-slate-700/50 text-purple-300 rounded-l-xl font-bold";
                btnGame.className = "flex-1 py-3 text-slate-400 hover:text-white font-bold";
                contentToast.classList.remove('hidden');
                contentGame.classList.add('hidden');
            } else {
                btnToast.className = "flex-1 py-3 text-slate-400 hover:text-white font-bold";
                btnGame.className = "flex-1 py-3 bg-slate-700/50 text-purple-300 rounded-r-xl font-bold";
                contentToast.classList.add('hidden');
                contentGame.classList.remove('hidden');
            }
        }

        // 本地化投票逻辑 (使用LocalStorage模拟)
        function initVote() {
            const counts = JSON.parse(localStorage.getItem('party_votes')) || { optionA: 0, optionB: 0 };
            updateVoteUI(counts);
        }

        function updateVoteUI(data) {
            const countA = data.optionA || 0;
            const countB = data.optionB || 0;
            const total = countA + countB;
            
            document.getElementById('count-optionA').innerText = countA;
            document.getElementById('count-optionB').innerText = countB;

            const pctA = total === 0 ? 0 : (countA / total) * 100;
            const pctB = total === 0 ? 0 : (countB / total) * 100;

            document.getElementById('bar-optionA').style.width = `${pctA}%`;
            document.getElementById('bar-optionB').style.width = `${pctB}%`;
        }

        function vote(option) {
            let counts = JSON.parse(localStorage.getItem('party_votes')) || { optionA: 0, optionB: 0 };
            counts[option] += 1;
            localStorage.setItem('party_votes', JSON.stringify(counts));
            updateVoteUI(counts);
            showToast("投票成功 (本地)");
        }

        // 初始化投票
        initVote();

        // 模拟 AI 生成 (本地预设数据)
        const toasts = [
            "冲哥34岁生日快乐！愿你搞钱如呼吸般简单，身体比20岁还硬朗！干了这杯！",
            "都说男人三十一枝花，冲哥你这朵花是越开越富贵！祝年年有今日，岁岁有今朝！",
            "兄弟一生一起走，冲哥生日必须有！祝未来的日子，酒有肉，卡有钱，人有爱！",
            "34岁正是黄金时代，祝冲哥事业腾飞，发际线坚挺，腹肌归位！"
        ];
        const games = [
            "<b>我有你没有：</b>轮流说一件自己做过但别人没做过的事，在场做过的人喝酒。",
            "<b>逢7过：</b>从1开始报数，逢7或7的倍数拍手，出错的喝酒。",
            "<b>逛三园：</b>水果园、蔬菜园、动物园，说不出来的喝酒。",
            "<b>大话骰：</b>最经典的酒吧游戏，无需多言，直接开摇！"
        ];

        function generateToast() {
            const outputDiv = document.getElementById('toastOutput');
            outputDiv.classList.remove('hidden');
            outputDiv.innerHTML = '<div class="loader"></div> 正在酝酿...';
            
            setTimeout(() => {
                const randomToast = toasts[Math.floor(Math.random() * toasts.length)];
                outputDiv.innerHTML = randomToast;
            }, 800);
        }

        function generateGame() {
            const outputDiv = document.getElementById('gameOutput');
            outputDiv.classList.remove('hidden');
            outputDiv.innerHTML = '<div class="loader"></div> 正在思考...';
            
            setTimeout(() => {
                const randomGame = games[Math.floor(Math.random() * games.length)];
                outputDiv.innerHTML = randomGame;
            }, 800);
        }
    </script>
</body>
</html>